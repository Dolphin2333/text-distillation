Using device: cuda
Loading validation data from ./scripts/mrpc_emb...
Val set shape: x=(408, 768), y=(408,)
Loading synthetic data from out_step5_ipc25_s4_tf_adamlr.h5...
[load_synthetic_data] torch.load failed on 'out_step5_ipc25_s4_tf_adamlr.h5', will try HDF5. Error: invalid load key, 'H'.
[load_synthetic_data] Trying to load 'out_step5_ipc25_s4_tf_adamlr.h5' as HDF5...
Synthetic set shape: X=(50, 768), y=(50,)
Using SDPA MATH backend for student training.
Training fresh text_transformer on synthetic set and evaluating on real MRPC val...
Building student model arch=text_transformer, width=256, d_emb=768, num_classes=2
[Epoch 200/1000] train_loss=0.0000 val_acc=39.22%
[Epoch 400/1000] train_loss=0.0000 val_acc=42.40%
[Epoch 600/1000] train_loss=0.0000 val_acc=43.87%
[Epoch 800/1000] train_loss=0.0000 val_acc=44.61%
[Epoch 1000/1000] train_loss=0.0000 val_acc=50.98%

=== FINAL DISTILLED-SET ACCURACY ON MRPC VAL: 50.98% ===
